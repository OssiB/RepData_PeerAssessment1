---
title: "Peer assistment 1"
output: html_document
author: Ossi Bister
---
```{r}
library("ggplot2")
library("doBy")
library("scales")
```

We read the data using *readCsv()* method and calculate the number of steps
utlizing 
*doBy* packages *summaryBy* method

```{r}
activityData <- read.csv("/Users/ossibister/Development/RepData_PeerAssessment1/activity.csv")
activityDataCleaned <- na.omit(activityData)
stepSummaryData <- summaryBy(steps~date,data = activityDataCleaned,FUN = sum)
stepSummaryData$date = as.POSIXct(stepSummaryData$date)
```


Histogram of the total number of steps taken each day ignoring missing values

```{r}
stepSummaryData$date <- as.POSIXct(stepSummaryData$date)
 ggplot(data = stepSummaryData,aes(x=date,y=steps.sum))+geom_histogram(stat="identity")+scale_x_datetime(breaks = date_breaks("1 weeks"),                                                                                labels = date_format("%d/%m"))+ggtitle("Total number of steps by day\n at time period 01.10.2013-30.11.2013")
```
Mean and median of the total number of steps taken per day

```{r}
meanSteps <- mean(stepSummaryData$steps.sum)
meadianSteps <- median(stepSummaryData$steps.sum)
```

Next we calculate average step count by interval
```{r}
stepIntervalMean <- summaryBy(steps~interval,data = activityDataCleaned,FUN = mean)
```
Because we need 5 minutes intervals we have first create vector
```{r}
fiveMinuteInterval <- seq(from = 0, to = 287*5, by = 5)
```
.. and attach the generated vector to *stepIntervalMean*
```{r}
stepIntervalMean$fiveMinutes <- fiveMinuteInterval
```
and finally plot the results
```{r}
 ggplot(data = stepIntervalMean,aes(x=fiveMinutes,y=steps.mean))+geom_line()
```
